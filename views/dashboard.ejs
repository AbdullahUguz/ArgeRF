<%- include('partials/_header') -%>

  <body>

    <%- include('partials/_navigation') -%>

      <!-- Main Content -->
      <div class="container" style="margin-top: 10%">


        <% if(user.role=='user' ) { %>
          <div class="container">
            <div class="row">
              <div class="col-lg-8 col-md-10 mx-auto">
                <div class="post-preview">
                  <h2 class="text-info">Lorem Ipsum</h2>
                  <p class="text-info">
                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio,
                    molestias?
                  </p>
                </div>
              </div>

              <!-- Mqtt Bilgisi -->
              <div class="col-lg-8 col-md-10 mx-auto">
                <h2 class="text-info mb-4">Mqtt Operation</h2>
                <!-- Publish -->
                <div class="form-row">
                  <form action="" class="mr-5">
                    <div class="form-group col-sm-12">
                      <label class="text-info">Publish Topic</label>
                      <input type="text" class="form-control" id="publishTopic" placeholder="Publish Topic">
                    </div>
                    <div class="form-group col-sm-12">
                      <label class="text-info" for="exampleFormControlTextarea1">Message</label>
                      <textarea class="form-control" id="message" rows="3"></textarea>
                    </div>
                    <div class="form-group col-sm-12">
                      <button type="submit" class="btn btn-primary">Publish</button>
                    </div>
                  </form>

                  <div class="form-group col-sm-3 ml-5">
                    <!-- Button subscribe modal -->
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModalCenter">
                      Add New Topic Subscribe
                    </button>
                  </div>

                  <div class="form-group col-sm-10 mt-5">
                    <table class="table">
                      <thead class="thead-light">
                        <tr>
                          <th scope="col" class="text-info">Message</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th scope="row">1</th>
                          <td>Mark</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <!-- Subscribe 
                  <form action="" class="ml-5">
                    <div class="form-group col-sm-12">
                      <label class="text-info">Subscribe Publish Topic</label>
                      <input type="text" class="form-control" id="subscribeTopic" placeholder="Subscribe Publish Topic">
                    </div>
                    <div class="form-group col-sm-12">
                      <label class="text-info" for="exampleFormControlTextarea1">Message</label>
                      <textarea class="form-control" id="message" rows="3"></textarea>
                    </div>
                    <div class="form-group col-sm-12">
                      <button type="submit" class="btn btn-primary">Subscribe</button>
                    </div>
                  </form>
                  -->
                  <!-- Subscribe Add Publish Modal -->
                  <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
                    aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                      <div class="modal-content">
                        <div class="modal-body">
                          <form action="">
                            <div class="form-group col-sm-12">
                              <label class="text-info">Subscribe Publish Topic</label>
                              <input type="text" class="form-control" id="subscribeTopic" placeholder="Subscribe Publish Topic">
                            </div>
                            <div class="form-group col-sm-12">
                              <button type="submit" class="btn btn-info btn-radius btn-brd grd1">
                                Subscribe
                              </button>
                              <button type="submit" class="btn btn-danger btn-radius btn-brd grd1"
                                data-dismiss="modal" aria-hidden="true">
                                Cancel
                              </button>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>

              </div>



            </div>
          </div>

          <% } %>

            <% if(user.role=='admin' ) { %>
              <div class="container">
                <div class="row mt-5">
                  <div class="col-lg-12 col-md-10 mx-auto">
                    <h2>USERS</h2>
                    <table class="table mb-5">
                      <thead>
                        <tr>
                          <th scope="col">#ID</th>
                          <th scope="col">Username</th>
                          <th scope="col">Email</th>
                          <th scope="col">Role</th>
                          <th scope="col">Update</th>
                          <th scope="col">Delete</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% for(let i=0; i< users.length;i++) { %>
                          <tr>
                            <th scope="row">
                              <%=users[i].id%>
                            </th>
                            <td>
                              <%=users[i].username%>
                            </td>
                            <td>
                              <%=users[i].email%>
                            </td>
                            <td>
                              <%=users[i].role%>
                            </td>
                            <td>
                              <button class="btn btn-warning rounded-0 text-white" data-toggle="modal"
                                data-target="#updateUser<%= users[i].id %>"><span>UPDATE</span>
                              </button>
                            </td>
                            <td>
                              <a href="/users/<%= users[i].id %>?_method=DELETE"
                                onclick="return confirm('Are You Sure ?')" class="btn btn-danger rounded-0 text-white">
                                <span>DELETE</span>
                              </a>
                            </td>
                          </tr>

                          <!-- UPDATE Modal -->
                          <div class="modal fade" id="updateUser<%= users[i].id %>" tabindex="-1" role="dialog"
                            aria-labelledby="myModalLabel">
                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                              <div class="modal-content">
                                <div class="modal-body customer-box">
                                  <!-- Tab panes -->
                                  <div class="tab-content">
                                    <h3 class="text-info"> Update User</h3>
                                    <div class="tab-pane active" id="Login">
                                      <form method="POST" action="/users/<%= users[i].id %>?_method=PUT"
                                        class="form-horizontal">
                                        <div class="form-group">
                                          <div class="col-sm-12">
                                            <input type="text" name="username" value="<%= users[i].username %>"
                                              class="form-control" placeholder="Username">
                                          </div>
                                        </div>
                                        <div class="form-group">
                                          <div class="col-sm-12">
                                            <input type="email" name="email" value="<%= users[i].email %>"
                                              class="form-control" placeholder="Email">
                                          </div>
                                        </div>
                                        <div class="form-group">
                                          <div class="col-sm-12">
                                            <input type="password" name="password" value="<%= users[i].password %>"
                                              class="form-control" placeholder="Password">
                                          </div>
                                        </div>
                                        <div class="form-group">
                                          <div class="col-sm-12">
                                            <select class="form-control" name="role">
                                              <option value="admin">admin</option>
                                              <option value="user">user</option>
                                            </select>
                                          </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                      <div class="col-sm-10">
                                        <button type="submit" class="btn btn-info btn-radius btn-brd grd1">
                                          Update
                                        </button>
                                        <button type="submit" class="btn btn-danger btn-radius btn-brd grd1"
                                          data-dismiss="modal" aria-hidden="true">
                                          Cancel
                                        </button>
                                      </div>
                                    </div>
                                    </form>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                          <% } %>
                            <tr>
                              <td>
                                <button class="btn btn-lg btn-info rounded-0 text-white " href="#" data-toggle="modal"
                                  data-target="#addUser">
                                  <span>ADD USER</span>
                                </button>
                              </td>
                            </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <!-- end row -->
              </div>

              <!-- User ADD Modal -->
              <div class="modal fade" id="addUser" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                  <div class="modal-content">
                    <div class="modal-body customer-box">
                      <!-- Tab panes -->
                      <div class="tab-content">
                        <h3 class="text-info"> Add User</h3>
                        <div class="tab-pane active" id="Login">
                          <form method="POST" action="/users/signup" class="form-horizontal">
                            <div class="form-group">
                              <div class="col-sm-12">
                                <input type="text" name="username" class="form-control" placeholder="Username">
                              </div>
                            </div>
                            <div class="form-group">
                              <div class="col-sm-12">
                                <input type="email" name="email" class="form-control" placeholder="Email">
                              </div>
                            </div>
                            <div class="form-group">
                              <div class="col-sm-12">
                                <input type="password" name="password" class="form-control" placeholder="Password">
                              </div>
                            </div>
                            <div class="form-group">
                              <div class="col-sm-12">
                                <select class="form-control" name="role">
                                  <option value="admin">admin</option>
                                  <option value="user">user</option>
                                </select>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-sm-10">
                                <button type="submit" class="btn btn-info btn-radius btn-brd grd1">
                                  Add
                                </button>
                                <button type="submit" class="btn btn-danger btn-radius btn-brd grd1"
                                  data-dismiss="modal" aria-hidden="true">
                                  Cancel
                                </button>
                              </div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <% } %>
              </div>
              <hr />
      </div>



      <%- include('partials/_footer') -%>
  </body>

  </html>